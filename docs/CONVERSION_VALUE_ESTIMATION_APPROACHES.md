# Approaches for Estimating Conversion Value

## 1. Introduction

To accurately calculate Return on Ad Spend (ROAS), we need to estimate the revenue generated from conversions. Using the `cpa_target` directly as a proxy for conversion value is not ideal, as the cost of acquiring a customer is often different from the value they bring. This document explores two alternative automated approaches to estimate this value.

---

## 2. Option 1: Automated Sitemap Analysis

This approach involves creating a service that crawls the sitemap provided during campaign creation. It would parse the linked pages to find data that indicates value, such as product prices or service fees.

### Sitemap Analysis Pros

- **Highly Accurate:** If prices can be successfully extracted, this method provides a very accurate, data-driven conversion value.
- **Fully Automated:** This process requires no additional input from the user beyond the initial sitemap URL, providing a seamless experience.
- **Dynamic:** Can be re-run periodically to update conversion values if prices on the website change.

### Sitemap Analysis Cons

- **Technical Complexity:** Requires building a robust web scraper and parser capable of handling different website structures, which is a significant engineering effort.
- **Brittleness:** It may not work for all types of businesses. It's best suited for e-commerce sites with clear pricing. It would likely fail for lead generation, B2B services, or sites without explicit pricing information.
- **Maintenance Overhead:** The scraper would need to be maintained as website structures change over time.

---

## 3. Option 2: Using the Strategy Agent's Estimated CPA

This approach leverages the estimated CPA generated by our internal strategy agent. We would use this CPA value, potentially multiplied by a fixed, system-wide factor, to estimate the conversion value.

### Estimated CPA Pros

- **Simple to Implement:** The estimated CPA is an existing data point that is readily available for every strategy.
- **No User Input Required:** Like the sitemap analysis, this is fully automated from the user's perspective.
- **Consistent:** Provides a uniform method for estimating value across all campaigns and strategies in the system.

### Estimated CPA Cons

- **Poor Proxy for Value:** The core issue remains. **CPA is a *cost* metric, not a *revenue* metric.** A high CPA doesn't mean a conversion isn't valuable, and a low CPA doesn't guarantee profitability. This approach is fundamentally flawed as it doesn't truly estimate the revenue side of the ROAS equation.
- **Inaccurate ROAS:** Because it doesn't reflect the actual revenue, the calculated ROAS would be a vanity metric, not an accurate measure of performance, which could lead to poor optimization decisions.

---

## 4. Recommendation

While a sitemap analyzer is powerful, its complexity and limitations make it a risky primary solution. The estimated CPA approach is too inaccurate to be reliable.

A recommended hybrid approach is to **add an optional `average_conversion_value` field to the `Campaign` model.**

- **How it works:** When creating a campaign, the user can optionally provide an average value for a single conversion.
- **If provided,** we use this user-defined value for the most accurate ROAS calculation.
- **If not provided,** we can fall back to using the `strategy->cpa_target` as a baseline estimate, acknowledging its limitations.

This solution strikes the best balance: it empowers knowledgeable users to provide accurate data while maintaining a simple, automated fallback for those who don't have this information readily available.
